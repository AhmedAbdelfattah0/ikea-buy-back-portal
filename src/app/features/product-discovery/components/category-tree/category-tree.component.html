<!-- Category Tree Navigation - Side by Side Columns (Desktop) / Single Column (Mobile) -->
<div class="category-tree">
  <h3 class="category-tree__title">{{ translations().productDiscovery.categories }}</h3>

  <!-- Mobile Back Button (shown when not at level 1) -->
  @if (mobileViewLevel() > 1) {
    <button
      type="button"
      class="mobile-back-button"
      (click)="mobileViewLevel() === 2 ? goBackToLevel1() : goBackToLevel2()"
    >
      <skapa-icon slot="icon" icon="chevron-left-small"></skapa-icon>

      <span class="back-text">{{ mobileBreadcrumbTitle() }}</span>
    </button>
  }

  <div class="category-columns">
    <!-- Level 1 - Main Categories -->
    <div class="category-column" [class.mobile-visible]="mobileViewLevel() === 1">
      <ul class="category-list">
        @for (category of rootCategories(); track category.id) {
          <li class="category-item">
            <button
              type="button"
              class="category-button"
              [class.category-button--selected]="isLevel1Selected(category)"
              [class.category-button--has-children]="hasChildren(category)"
              (click)="selectLevel1Category(category)"
            >
              <span class="category-name">{{ category.name }}</span>
              @if (hasChildren(category)) {
                <skapa-icon slot="icon" icon="chevron-right-small"></skapa-icon>
              }
            </button>
          </li>
        }
      </ul>
    </div>

    <!-- Level 2 - Subcategories (shown when level 1 selected) -->
    @if (level2Categories().length > 0) {
      <div class="category-column" [class.mobile-visible]="mobileViewLevel() === 2">
        <ul class="category-list">
          @for (category of level2Categories(); track category.id) {
            <li class="category-item">
              <button
                type="button"
                class="category-button"
                [class.category-button--selected]="isLevel2Selected(category)"
                [class.category-button--has-children]="hasChildren(category)"
                (click)="selectLevel2Category(category)"
              >
                <span class="category-name">{{ category.name }}</span>
                @if (hasChildren(category)) {
                  <skapa-icon slot="icon" icon="chevron-right-small"></skapa-icon>
                }
              </button>
            </li>
          }
        </ul>
      </div>
    }

    <!-- Level 3 - Sub-subcategories (shown when level 2 selected) -->
    @if (level3Categories().length > 0) {
      <div class="category-column" [class.mobile-visible]="mobileViewLevel() === 3">
        <ul class="category-list">
          @for (category of level3Categories(); track category.id) {
            <li class="category-item">
              <button
                type="button"
                class="category-button"
                [class.category-button--selected]="isLevel3Selected(category)"
                (click)="selectLevel3Category(category)"
              >
                <span class="category-name">{{ category.name }}</span>
              </button>
            </li>
          }
        </ul>
      </div>
    }
  </div>
</div>
